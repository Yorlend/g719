/*--------------------------------------------------------------------------*/
/* ITU-T G.719 Source Code                                                  */
/* > Software Release 1.0a (2008-06)                                        */
/* © 2008 Ericsson AB. and Polycom Inc.                                     */
/* All rights reserved.                                                     */
/*--------------------------------------------------------------------------*/

#include "stl.h"
#include "cnst.h"

Word16 short_window[480] = {
  107,   322,   536,   751,   965,  1179,  1394,  1608,  1822,  2036,  2250,  2464,
 2678,  2892,  3105,  3319,  3532,  3745,  3958,  4171,  4383,  4596,  4808,  5020,
 5232,  5444,  5655,  5866,  6077,  6288,  6498,  6708,  6918,  7127,  7336,  7545,
 7754,  7962,  8170,  8377,  8585,  8791,  8998,  9204,  9409,  9615,  9819, 10024,
10228, 10431, 10634, 10837, 11039, 11241, 11442, 11643, 11843, 12043, 12242, 12441,
12639, 12836, 13033, 13230, 13426, 13621, 13816, 14010, 14204, 14397, 14589, 14781,
14972, 15162, 15352, 15541, 15730, 15917, 16105, 16291, 16477, 16662, 16846, 17030,
17213, 17395, 17576, 17757, 17937, 18116, 18294, 18472, 18648, 18824, 18999, 19174,
19347, 19520, 19692, 19863, 20033, 20202, 20371, 20538, 20705, 20871, 21035, 21199,
21363, 21525, 21686, 21846, 22006, 22164, 22322, 22478, 22634, 22788, 22942, 23095,
23246, 23397, 23546, 23695, 23843, 23989, 24135, 24279, 24423, 24565, 24707, 24847,
24986, 25125, 25262, 25398, 25533, 25667, 25800, 25931, 26062, 26191, 26320, 26447,
26573, 26698, 26821, 26944, 27066, 27186, 27305, 27423, 27540, 27655, 27770, 27883,
27995, 28106, 28216, 28324, 28431, 28537, 28642, 28746, 28848, 28949, 29049, 29148,
29245, 29341, 29436, 29530, 29622, 29713, 29803, 29891, 29979, 30064, 30149, 30232,
30315, 30395, 30475, 30553, 30630, 30705, 30780, 30853, 30924, 30994, 31063, 31131,
31197, 31262, 31326, 31388, 31449, 31508, 31567, 31624, 31679, 31733, 31786, 31837,
31887, 31936, 31984, 32029, 32074, 32117, 32159, 32200, 32239, 32276, 32313, 32348,
32381, 32413, 32444, 32473, 32501, 32528, 32553, 32577, 32600, 32621, 32640, 32658,
32675, 32691, 32705, 32717, 32729, 32738, 32747, 32754, 32759, 32764, 32766, 32767,
32767, 32766, 32764, 32759, 32754, 32747, 32738, 32729, 32717, 32705, 32691, 32675,
32658, 32640, 32621, 32600, 32577, 32553, 32528, 32501, 32473, 32444, 32413, 32381,
32348, 32313, 32276, 32239, 32200, 32159, 32117, 32074, 32029, 31984, 31936, 31887,
31837, 31786, 31733, 31679, 31624, 31567, 31508, 31449, 31388, 31326, 31262, 31197,
31131, 31063, 30994, 30924, 30853, 30780, 30705, 30630, 30553, 30475, 30395, 30315,
30232, 30149, 30064, 29979, 29891, 29803, 29713, 29622, 29530, 29436, 29341, 29245,
29148, 29049, 28949, 28848, 28746, 28642, 28537, 28431, 28324, 28216, 28106, 27995,
27883, 27770, 27655, 27540, 27423, 27305, 27186, 27066, 26944, 26821, 26698, 26573,
26447, 26320, 26191, 26062, 25931, 25800, 25667, 25533, 25398, 25262, 25125, 24986,
24847, 24707, 24565, 24423, 24279, 24135, 23989, 23843, 23695, 23546, 23397, 23246,
23095, 22942, 22788, 22634, 22478, 22322, 22164, 22006, 21846, 21686, 21525, 21363,
21199, 21035, 20871, 20705, 20538, 20371, 20202, 20033, 19863, 19692, 19520, 19347,
19174, 18999, 18824, 18648, 18472, 18294, 18116, 17937, 17757, 17576, 17395, 17213,
17030, 16846, 16662, 16477, 16291, 16105, 15917, 15730, 15541, 15352, 15162, 14972,
14781, 14589, 14397, 14204, 14010, 13816, 13621, 13426, 13230, 13033, 12836, 12639,
12441, 12242, 12043, 11843, 11643, 11442, 11241, 11039, 10837, 10634, 10431, 10228,
10024,  9819,  9615,  9409,  9204,  8998,  8791,  8585,  8377,  8170,  7962,  7754,
 7545,  7336,  7127,  6918,  6708,  6498,  6288,  6077,  5866,  5655,  5444,  5232,
 5020,  4808,  4596,  4383,  4171,  3958,  3745,  3532,  3319,  3105,  2892,  2678,
 2464,  2250,  2036,  1822,  1608,  1394,  1179,   965,   751,   536,   322,   107
};

Word16 window[1920] = {
   27,    80,   134,   188,   241,   295,   349,   402,   456,   509,   563,   617,
  670,   724,   777,   831,   885,   938,   992,  1045,  1099,  1153,  1206,  1260,
 1313,  1367,  1420,  1474,  1528,  1581,  1635,  1688,  1742,  1795,  1849,  1902,
 1956,  2009,  2063,  2116,  2170,  2223,  2277,  2330,  2384,  2437,  2491,  2544,
 2598,  2651,  2705,  2758,  2811,  2865,  2918,  2972,  3025,  3078,  3132,  3185,
 3239,  3292,  3345,  3399,  3452,  3505,  3558,  3612,  3665,  3718,  3772,  3825,
 3878,  3931,  3985,  4038,  4091,  4144,  4197,  4251,  4304,  4357,  4410,  4463,
 4516,  4569,  4622,  4675,  4728,  4782,  4835,  4888,  4941,  4994,  5047,  5100,
 5153,  5205,  5258,  5311,  5364,  5417,  5470,  5523,  5576,  5628,  5681,  5734,
 5787,  5840,  5892,  5945,  5998,  6051,  6103,  6156,  6209,  6261,  6314,  6366,
 6419,  6472,  6524,  6577,  6629,  6682,  6734,  6787,  6839,  6891,  6944,  6996,
 7049,  7101,  7153,  7206,  7258,  7310,  7362,  7415,  7467,  7519,  7571,  7623,
 7676,  7728,  7780,  7832,  7884,  7936,  7988,  8040,  8092,  8144,  8196,  8248,
 8300,  8351,  8403,  8455,  8507,  8559,  8610,  8662,  8714,  8765,  8817,  8869,
 8920,  8972,  9023,  9075,  9127,  9178,  9229,  9281,  9332,  9384,  9435,  9486,
 9538,  9589,  9640,  9691,  9743,  9794,  9845,  9896,  9947,  9998, 10049, 10100,
10151, 10202, 10253, 10304, 10355, 10406, 10457, 10508, 10558, 10609, 10660, 10710,
10761, 10812, 10862, 10913, 10963, 11014, 11064, 11115, 11165, 11216, 11266, 11316,
11367, 11417, 11467, 11517, 11568, 11618, 11668, 11718, 11768, 11818, 11868, 11918,
11968, 12018, 12068, 12118, 12167, 12217, 12267, 12317, 12366, 12416, 12465, 12515,
12565, 12614, 12664, 12713, 12762, 12812, 12861, 12910, 12960, 13009, 13058, 13107,
13156, 13205, 13254, 13303, 13352, 13401, 13450, 13499, 13548, 13597, 13646, 13694,
13743, 13792, 13840, 13889, 13937, 13986, 14034, 14083, 14131, 14180, 14228, 14276,
14324, 14373, 14421, 14469, 14517, 14565, 14613, 14661, 14709, 14757, 14805, 14852,
14900, 14948, 14996, 15043, 15091, 15139, 15186, 15234, 15281, 15328, 15376, 15423,
15470, 15518, 15565, 15612, 15659, 15706, 15753, 15800, 15847, 15894, 15941, 15988,
16035, 16081, 16128, 16175, 16221, 16268, 16314, 16361, 16407, 16454, 16500, 16546,
16593, 16639, 16685, 16731, 16777, 16823, 16869, 16915, 16961, 17007, 17053, 17098,
17144, 17190, 17235, 17281, 17326, 17372, 17417, 17463, 17508, 17553, 17599, 17644,
17689, 17734, 17779, 17824, 17869, 17914, 17959, 18004, 18049, 18093, 18138, 18183,
18227, 18272, 18316, 18361, 18405, 18449, 18494, 18538, 18582, 18626, 18670, 18714,
18758, 18802, 18846, 18890, 18934, 18978, 19021, 19065, 19108, 19152, 19195, 19239,
19282, 19326, 19369, 19412, 19455, 19498, 19541, 19584, 19627, 19670, 19713, 19756,
19799, 19841, 19884, 19927, 19969, 20012, 20054, 20096, 20139, 20181, 20223, 20265,
20308, 20350, 20392, 20434, 20475, 20517, 20559, 20601, 20642, 20684, 20726, 20767,
20809, 20850, 20891, 20933, 20974, 21015, 21056, 21097, 21138, 21179, 21220, 21261,
21301, 21342, 21383, 21423, 21464, 21504, 21545, 21585, 21626, 21666, 21706, 21746,
21786, 21826, 21866, 21906, 21946, 21986, 22026, 22065, 22105, 22144, 22184, 22223,
22263, 22302, 22341, 22380, 22420, 22459, 22498, 22537, 22575, 22614, 22653, 22692,
22730, 22769, 22808, 22846, 22884, 22923, 22961, 22999, 23037, 23075, 23114, 23152,
23189, 23227, 23265, 23303, 23340, 23378, 23416, 23453, 23490, 23528, 23565, 23602,
23640, 23677, 23714, 23751, 23788, 23824, 23861, 23898, 23935, 23971, 24008, 24044,
24080, 24117, 24153, 24189, 24225, 24261, 24297, 24333, 24369, 24405, 24441, 24477,
24512, 24548, 24583, 24619, 24654, 24689, 24724, 24760, 24795, 24830, 24865, 24900,
24934, 24969, 25004, 25038, 25073, 25107, 25142, 25176, 25211, 25245, 25279, 25313,
25347, 25381, 25415, 25449, 25482, 25516, 25550, 25583, 25617, 25650, 25683, 25717,
25750, 25783, 25816, 25849, 25882, 25915, 25948, 25980, 26013, 26045, 26078, 26110,
26143, 26175, 26207, 26239, 26272, 26304, 26335, 26367, 26399, 26431, 26463, 26494,
26526, 26557, 26588, 26620, 26651, 26682, 26713, 26744, 26775, 26806, 26837, 26868,
26898, 26929, 26959, 26990, 27020, 27050, 27081, 27111, 27141, 27171, 27201, 27231,
27260, 27290, 27320, 27349, 27379, 27408, 27438, 27467, 27496, 27525, 27554, 27583,
27612, 27641, 27670, 27698, 27727, 27756, 27784, 27812, 27841, 27869, 27897, 27925,
27953, 27981, 28009, 28037, 28065, 28092, 28120, 28147, 28175, 28202, 28229, 28257,
28284, 28311, 28338, 28365, 28391, 28418, 28445, 28471, 28498, 28524, 28551, 28577,
28603, 28629, 28655, 28681, 28707, 28733, 28759, 28784, 28810, 28835, 28861, 28886,
28911, 28937, 28962, 28987, 29012, 29037, 29061, 29086, 29111, 29135, 29160, 29184,
29209, 29233, 29257, 29281, 29305, 29329, 29353, 29377, 29401, 29424, 29448, 29471,
29495, 29518, 29541, 29564, 29587, 29610, 29633, 29656, 29679, 29702, 29724, 29747,
29769, 29792, 29814, 29836, 29858, 29880, 29902, 29924, 29946, 29968, 29989, 30011,
30032, 30054, 30075, 30096, 30118, 30139, 30160, 30181, 30201, 30222, 30243, 30263,
30284, 30304, 30325, 30345, 30365, 30385, 30405, 30425, 30445, 30465, 30485, 30504,
30524, 30543, 30563, 30582, 30601, 30620, 30639, 30658, 30677, 30696, 30715, 30733,
30752, 30770, 30789, 30807, 30825, 30843, 30862, 30880, 30897, 30915, 30933, 30951,
30968, 30986, 31003, 31020, 31038, 31055, 31072, 31089, 31106, 31123, 31139, 31156,
31172, 31189, 31205, 31222, 31238, 31254, 31270, 31286, 31302, 31318, 31334, 31349,
31365, 31380, 31396, 31411, 31426, 31441, 31456, 31471, 31486, 31501, 31516, 31530,
31545, 31559, 31574, 31588, 31602, 31617, 31631, 31645, 31658, 31672, 31686, 31700,
31713, 31726, 31740, 31753, 31766, 31779, 31792, 31805, 31818, 31831, 31844, 31856,
31869, 31881, 31894, 31906, 31918, 31930, 31942, 31954, 31966, 31978, 31989, 32001,
32012, 32024, 32035, 32046, 32058, 32069, 32080, 32090, 32101, 32112, 32123, 32133,
32144, 32154, 32164, 32174, 32185, 32195, 32205, 32214, 32224, 32234, 32243, 32253,
32262, 32272, 32281, 32290, 32299, 32308, 32317, 32326, 32335, 32343, 32352, 32360,
32369, 32377, 32385, 32393, 32401, 32409, 32417, 32425, 32433, 32440, 32448, 32455,
32463, 32470, 32477, 32484, 32491, 32498, 32505, 32512, 32518, 32525, 32531, 32538,
32544, 32550, 32556, 32562, 32568, 32574, 32580, 32586, 32591, 32597, 32602, 32608,
32613, 32618, 32623, 32628, 32633, 32638, 32643, 32647, 32652, 32656, 32661, 32665,
32669, 32673, 32677, 32681, 32685, 32689, 32692, 32696, 32700, 32703, 32706, 32710,
32713, 32716, 32719, 32722, 32724, 32727, 32730, 32732, 32735, 32737, 32739, 32742,
32744, 32746, 32748, 32750, 32751, 32753, 32755, 32756, 32757, 32759, 32760, 32761,
32762, 32763, 32764, 32765, 32766, 32766, 32767, 32767, 32767, 32767, 32767, 32767,
32767, 32767, 32767, 32767, 32767, 32767, 32766, 32766, 32765, 32764, 32763, 32762,
32761, 32760, 32759, 32757, 32756, 32755, 32753, 32751, 32750, 32748, 32746, 32744,
32742, 32739, 32737, 32735, 32732, 32730, 32727, 32724, 32722, 32719, 32716, 32713,
32710, 32706, 32703, 32700, 32696, 32692, 32689, 32685, 32681, 32677, 32673, 32669,
32665, 32661, 32656, 32652, 32647, 32643, 32638, 32633, 32628, 32623, 32618, 32613,
32608, 32602, 32597, 32591, 32586, 32580, 32574, 32568, 32562, 32556, 32550, 32544,
32538, 32531, 32525, 32518, 32512, 32505, 32498, 32491, 32484, 32477, 32470, 32463,
32455, 32448, 32440, 32433, 32425, 32417, 32409, 32401, 32393, 32385, 32377, 32369,
32360, 32352, 32343, 32335, 32326, 32317, 32308, 32299, 32290, 32281, 32272, 32262,
32253, 32243, 32234, 32224, 32214, 32205, 32195, 32185, 32174, 32164, 32154, 32144,
32133, 32123, 32112, 32101, 32090, 32080, 32069, 32058, 32046, 32035, 32024, 32012,
32001, 31989, 31978, 31966, 31954, 31942, 31930, 31918, 31906, 31894, 31881, 31869,
31856, 31844, 31831, 31818, 31805, 31792, 31779, 31766, 31753, 31740, 31726, 31713,
31700, 31686, 31672, 31658, 31645, 31631, 31617, 31602, 31588, 31574, 31559, 31545,
31530, 31516, 31501, 31486, 31471, 31456, 31441, 31426, 31411, 31396, 31380, 31365,
31349, 31334, 31318, 31302, 31286, 31270, 31254, 31238, 31222, 31205, 31189, 31172,
31156, 31139, 31123, 31106, 31089, 31072, 31055, 31038, 31020, 31003, 30986, 30968,
30951, 30933, 30915, 30897, 30880, 30862, 30843, 30825, 30807, 30789, 30770, 30752,
30733, 30715, 30696, 30677, 30658, 30639, 30620, 30601, 30582, 30563, 30543, 30524,
30504, 30485, 30465, 30445, 30425, 30405, 30385, 30365, 30345, 30325, 30304, 30284,
30263, 30243, 30222, 30201, 30181, 30160, 30139, 30118, 30096, 30075, 30054, 30032,
30011, 29989, 29968, 29946, 29924, 29902, 29880, 29858, 29836, 29814, 29792, 29769,
29747, 29724, 29702, 29679, 29656, 29633, 29610, 29587, 29564, 29541, 29518, 29495,
29471, 29448, 29424, 29401, 29377, 29353, 29329, 29305, 29281, 29257, 29233, 29209,
29184, 29160, 29135, 29111, 29086, 29061, 29037, 29012, 28987, 28962, 28937, 28911,
28886, 28861, 28835, 28810, 28784, 28759, 28733, 28707, 28681, 28655, 28629, 28603,
28577, 28551, 28524, 28498, 28471, 28445, 28418, 28391, 28365, 28338, 28311, 28284,
28257, 28229, 28202, 28175, 28147, 28120, 28092, 28065, 28037, 28009, 27981, 27953,
27925, 27897, 27869, 27841, 27812, 27784, 27756, 27727, 27698, 27670, 27641, 27612,
27583, 27554, 27525, 27496, 27467, 27438, 27408, 27379, 27349, 27320, 27290, 27260,
27231, 27201, 27171, 27141, 27111, 27081, 27050, 27020, 26990, 26959, 26929, 26898,
26868, 26837, 26806, 26775, 26744, 26713, 26682, 26651, 26620, 26588, 26557, 26526,
26494, 26463, 26431, 26399, 26367, 26335, 26304, 26272, 26239, 26207, 26175, 26143,
26110, 26078, 26045, 26013, 25980, 25948, 25915, 25882, 25849, 25816, 25783, 25750,
25717, 25683, 25650, 25617, 25583, 25550, 25516, 25482, 25449, 25415, 25381, 25347,
25313, 25279, 25245, 25211, 25176, 25142, 25107, 25073, 25038, 25004, 24969, 24934,
24900, 24865, 24830, 24795, 24760, 24724, 24689, 24654, 24619, 24583, 24548, 24512,
24477, 24441, 24405, 24369, 24333, 24297, 24261, 24225, 24189, 24153, 24117, 24080,
24044, 24008, 23971, 23935, 23898, 23861, 23824, 23788, 23751, 23714, 23677, 23640,
23602, 23565, 23528, 23490, 23453, 23416, 23378, 23340, 23303, 23265, 23227, 23189,
23152, 23114, 23075, 23037, 22999, 22961, 22923, 22884, 22846, 22808, 22769, 22730,
22692, 22653, 22614, 22575, 22537, 22498, 22459, 22420, 22380, 22341, 22302, 22263,
22223, 22184, 22144, 22105, 22065, 22026, 21986, 21946, 21906, 21866, 21826, 21786,
21746, 21706, 21666, 21626, 21585, 21545, 21504, 21464, 21423, 21383, 21342, 21301,
21261, 21220, 21179, 21138, 21097, 21056, 21015, 20974, 20933, 20891, 20850, 20809,
20767, 20726, 20684, 20642, 20601, 20559, 20517, 20475, 20434, 20392, 20350, 20308,
20265, 20223, 20181, 20139, 20096, 20054, 20012, 19969, 19927, 19884, 19841, 19799,
19756, 19713, 19670, 19627, 19584, 19541, 19498, 19455, 19412, 19369, 19326, 19282,
19239, 19195, 19152, 19108, 19065, 19021, 18978, 18934, 18890, 18846, 18802, 18758,
18714, 18670, 18626, 18582, 18538, 18494, 18449, 18405, 18361, 18316, 18272, 18227,
18183, 18138, 18093, 18049, 18004, 17959, 17914, 17869, 17824, 17779, 17734, 17689,
17644, 17599, 17553, 17508, 17463, 17417, 17372, 17326, 17281, 17235, 17190, 17144,
17098, 17053, 17007, 16961, 16915, 16869, 16823, 16777, 16731, 16685, 16639, 16593,
16546, 16500, 16454, 16407, 16361, 16314, 16268, 16221, 16175, 16128, 16081, 16035,
15988, 15941, 15894, 15847, 15800, 15753, 15706, 15659, 15612, 15565, 15518, 15470,
15423, 15376, 15328, 15281, 15234, 15186, 15139, 15091, 15043, 14996, 14948, 14900,
14852, 14805, 14757, 14709, 14661, 14613, 14565, 14517, 14469, 14421, 14373, 14324,
14276, 14228, 14180, 14131, 14083, 14034, 13986, 13937, 13889, 13840, 13792, 13743,
13694, 13646, 13597, 13548, 13499, 13450, 13401, 13352, 13303, 13254, 13205, 13156,
13107, 13058, 13009, 12960, 12910, 12861, 12812, 12762, 12713, 12664, 12614, 12565,
12515, 12465, 12416, 12366, 12317, 12267, 12217, 12167, 12118, 12068, 12018, 11968,
11918, 11868, 11818, 11768, 11718, 11668, 11618, 11568, 11517, 11467, 11417, 11367,
11316, 11266, 11216, 11165, 11115, 11064, 11014, 10963, 10913, 10862, 10812, 10761,
10710, 10660, 10609, 10558, 10508, 10457, 10406, 10355, 10304, 10253, 10202, 10151,
10100, 10049,  9998,  9947,  9896,  9845,  9794,  9743,  9691,  9640,  9589,  9538,
 9486,  9435,  9384,  9332,  9281,  9229,  9178,  9127,  9075,  9023,  8972,  8920,
 8869,  8817,  8765,  8714,  8662,  8610,  8559,  8507,  8455,  8403,  8351,  8300,
 8248,  8196,  8144,  8092,  8040,  7988,  7936,  7884,  7832,  7780,  7728,  7676,
 7623,  7571,  7519,  7467,  7415,  7362,  7310,  7258,  7206,  7153,  7101,  7049,
 6996,  6944,  6891,  6839,  6787,  6734,  6682,  6629,  6577,  6524,  6472,  6419,
 6366,  6314,  6261,  6209,  6156,  6103,  6051,  5998,  5945,  5892,  5840,  5787,
 5734,  5681,  5628,  5576,  5523,  5470,  5417,  5364,  5311,  5258,  5205,  5153,
 5100,  5047,  4994,  4941,  4888,  4835,  4782,  4728,  4675,  4622,  4569,  4516,
 4463,  4410,  4357,  4304,  4251,  4197,  4144,  4091,  4038,  3985,  3931,  3878,
 3825,  3772,  3718,  3665,  3612,  3558,  3505,  3452,  3399,  3345,  3292,  3239,
 3185,  3132,  3078,  3025,  2972,  2918,  2865,  2811,  2758,  2705,  2651,  2598,
 2544,  2491,  2437,  2384,  2330,  2277,  2223,  2170,  2116,  2063,  2009,  1956,
 1902,  1849,  1795,  1742,  1688,  1635,  1581,  1528,  1474,  1420,  1367,  1313,
 1260,  1206,  1153,  1099,  1045,   992,   938,   885,   831,   777,   724,   670,
  617,   563,   509,   456,   402,   349,   295,   241,   188,   134,    80,    27
};
